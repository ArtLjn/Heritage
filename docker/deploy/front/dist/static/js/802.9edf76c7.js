"use strict";(self["webpackChunkheritage"]=self["webpackChunkheritage"]||[]).push([[802],{2636:function(t,e,a){a.d(e,{Dx:function(){return u},az:function(){return n},l0:function(){return r},nU:function(){return l}});a(4114);var o=a(5720),c=a(9325);const n=t=>o.A.post("/api/account/login",t),l=()=>{const t=localStorage.getItem("city");t&&o.A.get(`/api/account/logout?city=${t}`).then((t=>{200===t.data.code&&(localStorage.clear(),c.A.push("/admin"))})).catch((t=>{localStorage.clear(),c.A.push("/admin")}))},r=()=>{const t=localStorage.getItem("token");t&&(o.A.interceptors.request.use((e=>(e.headers.Authorization=t,e))),o.A.get("/api/account/verifyToken").then((t=>{200===t.data.code?c.A.push("/adminHome"):(c.A.push("/admin"),localStorage.clear())})).catch((t=>{c.A.push("/admin"),localStorage.clear()})))},u=()=>o.A.get("/api/account/getAllAccount")},6802:function(t,e,a){a.r(e),a.d(e,{default:function(){return d}});var o=a(6768);function c(t,e,a,c,n,l){const r=(0,o.g2)("el-input"),u=(0,o.g2)("el-form-item"),i=(0,o.g2)("el-button"),d=(0,o.g2)("el-form"),s=(0,o.g2)("el-table-column"),p=(0,o.g2)("el-table");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(d,{inline:"",style:{float:"left"}},{default:(0,o.k6)((()=>[(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(r,{modelValue:n.currentCity,"onUpdate:modelValue":e[0]||(e[0]=t=>n.currentCity=t),placeholder:"输入相关城市信息"},null,8,["modelValue"])])),_:1}),(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,{type:"warning",plain:"",onClick:l.downloadFile},{default:(0,o.k6)((()=>[(0,o.eW)("导出Excel")])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(p,{data:n.Accounts,class:"custom-table",stripe:"",lazy:!0,border:"",height:"700"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{label:"ID",width:"100",prop:"id"}),(0,o.bF)(s,{label:"Address",width:"400",prop:"address"}),(0,o.bF)(s,{label:"Password",width:"120",prop:"password"}),(0,o.bF)(s,{label:"City",width:"200",prop:"city"}),(0,o.bF)(s,{label:"Level",width:"100",prop:"level"})])),_:1},8,["data"])],64)}a(4603),a(7566),a(8721);var n=a(2636),l=a(4635),r={name:"ManagerAccount",data(){return{Accounts:[],currentCity:"",AccountCopy:[]}},mounted(){(0,n.Dx)().then((t=>{this.Accounts=t.data.data[0],this.AccountCopy=t.data.data[0]}))},methods:{async downloadFile(){try{const t=await(0,l.A)({url:"/api/account/exportAccount",method:"GET",responseType:"blob",headers:{Authorization:localStorage.getItem("token")}}),e=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=e,a.setAttribute("download","Account.xlsx"),document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(e),document.body.removeChild(a)}catch(t){console.error("下载文件失败",t)}}},watch:{currentCity(t){const e=t.toLowerCase().split(" ");this.Accounts=this.AccountCopy.map((t=>{let a=0;const o=new RegExp(e.join("|"),"gi"),c=`${t.id} ${t.city} ${t.level}`.toLowerCase();return c.replace(o,(()=>(a++,""))),{acc:t,matches:a}})).filter((t=>t.matches>0)).sort(((t,e)=>e.matches-t.matches)).map((t=>t.acc)),""!==t&&null!==t||(this.Accounts=this.AccountCopy)}}},u=a(1241);const i=(0,u.A)(r,[["render",c]]);var d=i}}]);